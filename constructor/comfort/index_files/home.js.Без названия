$(function(){
	$('#home-gallery').each(function(){
		var el = $(this),
			nav = el.find('.nav'),
			td_height = 0;
		banner_gall(el);
		$(window).resize(function() {
			banner_gall(el);
		});
		nav.find('p').each(function(){
			td_height = ($(this).height() > td_height) ?
						$(this).height() :
						td_height;

			nav.find('p:first').trigger('click');

			$(this).click(function(){
				var link = $(this),
					wrap_link = link.closest('td'),
					num = wrap_link.index(),
					arr = '<i class="arr"></i><i class="shadow"></i>';

				if(!wrap_link.hasClass('active')){
					el.find('.item')
						.removeClass('show')
						.eq(num).addClass('show');

					nav.find('td').removeClass('active');
					nav.find('.arr, .shadow').remove();
					wrap_link.addClass('active').find('p').append(arr);

					banner_reset();

					if(document.all && !document.addEventListener){
					    return;
					}

					switch(num){
						case 0:
							banner_1();
							break;
						case 1:
							banner_2();
							break;
						case 2:
							banner_3();
							break;
					}
				}

			});
		});
		nav.find('p').height(td_height);
	});
function banner_reset(){
	$('.banner-2 img, .banner-1 img, .banner-3 img')
		.stop(true, true, true)
		.removeAttr('style');

	$('.imgSet').removeClass('done');
	$('.banner-2 .info').removeAttr('style');
}

function banner_1(){
	$('.banner-1 .img-1').animate({
		'opacity'	: 1,
		'left'		: 35
	}, 800, function(){
		$('.banner-1 .img-2').animate({
			'opacity'	: 1,
			'left'		: 196
		}, 900);
		$('.banner-1 .img-5').animate({
			'opacity'	: 1,
			'left'		: 540
		}, 600, function(){
			$('.banner-1 .img-3').animate({
				'opacity'	: 1,
				'left'		: 259
			}, 1000);
			$('.banner-1 .img-4').animate({
				'opacity'	: 1,
				'left'		: 260
			}, 1000, function(){
				$(this).closest('.imgSet').addClass('done');
			});
		});
	});
	$('.banner-1').on('mousemove', '.done', function(e){
		var pos_x = $(this).position().left,
			body_width = $('body').outerWidth(),
			wrap_width = $('.wrap').outerWidth(),
			padding = (body_width - wrap_width)/2;

		var x = parseInt(e.pageX - padding - 743, 10);

		if(35 + x/9 < 35)$('.banner-1 .img-1').css({ left: 35 + x/9 + "px" });
		if(196 + x/10 < 196) $('.banner-1 .img-2').css({ left: 196 + x/10 + "px" });
		if(259 + x/30 < 259) $('.banner-1 .img-3').css({ left: 259 + x/30 + "px" });
		if(260 + x/40 < 260) $('.banner-1 .img-4').css({ left: 260 + x/40 + "px" });
		if(540 + x/30 < 540) $('.banner-1 .img-5').css({ left: 540 + x/30 + "px" });
	}).on('mouseleave', '.done', function(){
		$('.banner-1 img').stop(true, true, true);
	});
}
function banner_2(){
	$('.banner-2 .img-3').animate({
		'opacity'	: 1,
		'top'		: 103
	}, 600, function(){
		$('.banner-2 .img-6').animate({
			'opacity'	: 1,
			'top'		: 233
		}, 700);
		$('.banner-2 .img-2').animate({
			'opacity'	: 1,
			'top'		: 81
		}, 600, function(){
			$('.banner-2 .img-1').animate({
				'opacity'	: 1,
				'top'		: 4
			}, 600);
			$('.banner-2 .img-4').animate({
				'opacity'	: 1,
				'left'		: 26
			}, 600);
			$('.banner-2 .img-5').animate({
				'opacity'	: 1,
				'left'		: 450
			}, 600);
			$('.banner-2 .info').animate({'opacity': 1}, 600, function(){
				$(this).closest('.imgSet').addClass('done');
			});
		});
	});
	$('.banner-2').on('mousemove', '.done', function(e){
		var pos_x = $(this).position().left,
			body_width = $('body').outerWidth(),
			wrap_width = $('.wrap').outerWidth(),
			padding = (body_width - wrap_width)/2;

		var x = parseInt(e.pageX - padding - 743, 10);

		if(173 + x/9 < 173)$('.banner-2 .img-1').css({ left: 173 + x/9 + "px" });
		if(172 + x/10 < 172) $('.banner-2 .img-2').css({ left: 172 + x/10 + "px" });
		if(143 + x/30 < 143) $('.banner-2 .img-3').css({ left: 143 + x/30 + "px" });
		if(26 + x/40 < 26) $('.banner-2 .img-4').css({ left: 26 + x/40 + "px" });
		if(450 + x/30 < 450) $('.banner-2 .img-5').css({ left: 450 + x/30 + "px" });
		if(63 + x/30 < 63) $('.banner-2 .img-6').css({ left: 63 + x/30 + "px" });
	}).on('mouseleave', '.done', function(){
		$('.banner-2 img').stop(true, true, true);
	});
}
function banner_3(){
	$('.banner-3 .img-1').animate({
		'opacity'	: 1
	}, 600, function(){
		$('.banner-3 .img-2').animate({
			'opacity'	: 1
		}, 600, function(){
			$('.banner-3 .img-3').animate({
				'opacity'	: 1
			}, 600, function(){
				$('.banner-3 .img-4').animate({
					'opacity'	: 1
				}, 600);
			});
		});
	});
}
});
function banner_gall(el){
	var body_width = parseInt($('body').width(), 10);

	if(body_width < 1020){
		el.width(998);
	} else {
		el.width('auto');
	}
}
