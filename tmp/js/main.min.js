/*! main.js*/
function orderSum(){$('[data-type="constr"]').not(".subList").each((function(){var $this=$(this),$priceTotal=$this.find(".price"),$priceBlock=$this.find(".price-one"),$price=parseInt(0),$count=parseInt($this.find(".count input").val());$('.subList[data-type="constr"][data-id="'+$this.attr("data-id")+'"]').each((function(){var $this=$(this);$price+=parseInt($this.find(".price-one").attr("data-price"))*$this.find(".count .info").text()})),0==$price?($priceBlock.attr("data-price",$price).text("По запросу"),$priceTotal.attr("data-price",$price).text("По запросу")):($priceBlock.attr("data-price",$price).html(number_format($price,0,"."," ")+" &#8381;"),$priceTotal.attr("data-price",$price*$count).html(number_format($price*$count,0,"."," ")+" &#8381;"))}));var sum=0,el=$(this);$(".orderTbl tr").not(".subList").each((function(){var el=$(this);if(void 0!==el.attr("data-type")&&"constr"==el.attr("data-type")){var val=parseInt(el.find(".num").val(),10)||0,price=parseInt(el.find(".price").attr("data-price"),10)||0;sum+=price}else{var val,price,curPrice=(parseInt(el.find(".num").val(),10)||0)*(price=parseInt(el.find(".price-one").attr("data-price"),10)||0);sum+=curPrice,0==curPrice?el.find(".price").attr("data-price",0).html("По запросу"):el.find(".price").attr("data-price",curPrice).html(number_format(curPrice,0,"."," ")+" &#8381;")}})),0==parseInt(sum)?sum="по запросу":(sum=accounting.formatMoney(sum,{symbol:"$",decimal:"",thousand:" ",precision:0,format:"%v"}),sum+=" &#8381;"),$("#summ").html(sum)}